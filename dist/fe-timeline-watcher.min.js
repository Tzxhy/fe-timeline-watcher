/* 这是一个测试哈*/
var __FE_TIMELINE_WATCHER__=function(){"use strict";var a,b=function(){};(function(a){a[a.FIRST_PAGE=0]="FIRST_PAGE",a[a.LOAD_RESOURCE=1]="LOAD_RESOURCE",a[a.ERROR=2]="ERROR",a[a.CUSTOM_DATA=3]="CUSTOM_DATA"})(a||(a={}));var c=function(){function c(d,e,f,g){var h;void 0===e&&(e=!0),void 0===f&&(f=!0),void 0===g&&(g=!0);var i=this;if(!d)throw new Error("\u6784\u9020\u51FD\u6570\u9700\u8981\u63A5\u6536watcherUrl\u53C2\u6570\uFF01");if(!(window.performance&&window.performance.getEntries))return console.info("Your browser doesn't support Performance API. We cann't record any data. See you."),null;if(window.PerformanceObserver){this.getLatestEntries=this.getLatestEntries.bind(this);var j=new PerformanceObserver(this.getLatestEntries);j.observe({entryTypes:["resource"]})}if(c.watcherUrl=d,this._sendType=a.FIRST_PAGE,this._hasReadIndex=0,this._messageBuf=[],this.doOnce(),"complete"!==document.readyState){var k=window.onload||b;window.onload=function(a){return setTimeout(function(){var a;a=c.getFirstEntries(),i._entriesPageLoad=a[0],i._entriesResource=a[1],i._hasReadIndex=0,i.sendData()},0),k.bind(a).call(a)}}else h=c.getFirstEntries(),this._entriesPageLoad=h[0],this._entriesResource=h[1],this._hasReadIndex=0,this.sendData()}return c.getFirstEntries=function(){return[performance.getEntriesByType("navigation"),performance.getEntriesByType("resource")]},c.prototype.doOnce=function(){var c,d=this,e={};c=window.navigator,e.platform=c.platform,e.userAgent=c.userAgent,this.browserInfo=e;var f=window.onerror||b;window.onerror=function(b,c,e,g,h){var i=b.toLowerCase();if(-1<i.indexOf("script error"))console.log("Script Error: See Browser Console for Detail");else{var j=["Message: "+b,"URL: "+c,"Line: "+e,"Column: "+g,"Error object: "+JSON.stringify(h)].join("\n");d._errorMsg=j,d._sendType=a.ERROR,d.sendData()}return f(b,c,e,g,h)}},c.compute=function(a){var b=a.domainLookupStart,d=a.domainLookupEnd,e=a.duration,f=a.name,g=a.responseStart,h=a.responseEnd;e=c.getShortS(""+e);var i=c.getShortS(""+(d-b)),j=c.getShortS(""+(h-g));return{dnsTime:i,duration:e,url:f,responseTime:j}},c.prototype.getLatestEntries=function(b){var d,e=this;clearTimeout(c.updateTimer);var f=b.getEntriesByType("resource");f=f.filter(function(a){return-1===a.name.indexOf(c.watcherUrl)}),0<f.length&&((d=c._tempResource).push.apply(d,f),c.updateTimer=setTimeout(function(){e._entriesResource=c._tempResource,c._tempResource=[],e._sendType=a.LOAD_RESOURCE,e.sendData()},1e3))},c.getShortS=function(a){return a.slice(0,8)},c.useOwnSender=function(a){if(!a)throw new Error("useOwnSender\u9700\u8981\u63A5\u6536\u4E00\u4E2Asender\u51FD\u6570\u4F5C\u4E3A\u53C2\u6570");c._sender=a},c.prototype.sendData=function(b){var d=b?{cData:b}:{};switch(this._sendType){case a.FIRST_PAGE:d.browserInfo=this.browserInfo,d.type=a.FIRST_PAGE,d.pageLoad=c.compute(this._entriesPageLoad[0]),d.resource=this._entriesResource.map(c.compute);break;case a.LOAD_RESOURCE:d.type=a.LOAD_RESOURCE,d.resource=this._entriesResource.map(c.compute);break;case a.ERROR:d.error=this._errorMsg,d.browserInfo=this.browserInfo,d.type=a.ERROR;break;default:}return c._sender?c._sender(d):this.originSendData(d)},c.prototype.originSendData=function(a){var b,d=encodeURIComponent(JSON.stringify(a));return b=2e3<d.length?fetch(c.watcherUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},body:"data="+d}):fetch(c.watcherUrl+"?data="+d),b},c.prototype.sendCustom=function(b){this._sendType=a.CUSTOM_DATA,this.sendData(b)},c.start=function(a,b,d,e){return void 0===b&&(b=!0),void 0===d&&(d=!0),void 0===e&&(e=!0),new c(a,b,d,e)},c._tempResource=[],c}();return c}();
